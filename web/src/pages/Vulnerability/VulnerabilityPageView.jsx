import NavigateNextIcon from "@mui/icons-material/NavigateNext";
import { Box, Breadcrumbs, Link, Stack, Typography } from "@mui/material";
import PropTypes from "prop-types";
import { useNavigate } from "react-router-dom";

import { VulnerabilityView } from "./VulnerabilityView";

export function VulnerabilityPageView(props) {
  const {
    packageId,
    vuln,
    vulnActions,
    matchedVulnPackage,
    service,
    hrefToServicePage,
    hrefToPackagePage,
  } = props;

  window.scrollTo({ top: 0, behavior: "instant" });

  const navigate = useNavigate();

  return (
    <>
      <Breadcrumbs separator={<NavigateNextIcon fontSize="small" />} aria-label="breadcrumb">
        <Link
          onClick={() => navigate(hrefToServicePage)}
          sx={{ color: "text.primary", cursor: "pointer" }}
        >
          {service.service_name}
        </Link>
        <Link
          onClick={() => navigate(hrefToPackagePage)}
          sx={{ color: "text.primary", cursor: "pointer" }}
        >
          {`${focusedServicePackage.name}:${focusedServicePackage.ecosystem}`}
        </Link>
        <Typography sx={{ color: "text.primary" }}>{vuln.title}</Typography>
      </Breadcrumbs>
      <Typography variant="h4" sx={{ fontWeight: "bold", py: 2 }}>
        {vuln.title}
      </Typography>
      <Box>
        <Stack spacing={2} sx={{ mb: 3 }}>
          <VulnerabilityView
            packageId={packageId}
            vuln={vuln}
            vulnActions={vulnActions}
            matchedVulnPackage={matchedVulnPackage}
          />
        </Stack>
      </Box>
    </>
  );
}
VulnerabilityPageView.propTypes = {
  packageId: PropTypes.string.isRequired,
  vuln: PropTypes.object.isRequired,
  vulnActions: PropTypes.array.isRequired,
  matchedVulnPackage: PropTypes.object.isRequired,
  service: PropTypes.object.isRequired,
  hrefToServicePage: PropTypes.string.isRequired,
  hrefToPackagePage: PropTypes.string.isRequired,
};
