// === 共通ID定数 ===
export const pteamId = "pteam-abc-123";
export const serviceId = "service-xyz-789";
export const packageId = "pkg-uuid-456";
// === 共通モックデータ ===
export const mockPTeam = {
  pteam_id: pteamId,
  pteam_name: "Example Team",
  services: [
    {
      service_id: serviceId,
      service_name: "My Production Service",
      service_safety_impact: "negligible",
    },
  ],
};
export const mockDependencies = [
  {
    dependency_id: "dep-1",
    target: "pom.xml",
    package_version: "1.2.3",
    package_name: "log4j",
    package_source_name: "org.apache.logging:log4j-core",
    package_manager: "maven",
    package_ecosystem: "maven",
    vuln_matching_ecosystem: "maven",
  },
  {
    dependency_id: "dep-2",
    target: "another.xml",
    package_version: "1.2.3",
    package_name: "log4j",
    package_source_name: "org.apache.logging:log4j-core",
    package_manager: "maven",
    package_ecosystem: "maven",
  },
  {
    dependency_id: "dep-3",
    target: "requirements.txt",
    package_version: "2.0.0",
    package_name: "log4j",
    package_source_name: "org.apache.logging:log4j-core",
    package_manager: "pip",
    package_ecosystem: "pypi",
    vuln_matching_ecosystem: "pypi",
  },
  {
    dependency_id: "dep-4",
    target: "package.json",
    package_version: "3.0.0",
    package_name: "log4js",
    package_source_name: "log4js",
    package_manager: "npm",
    package_ecosystem: "npm",
    vuln_matching_ecosystem: "npm",
  },
  {
    dependency_id: "dep-5",
    target: "go.mod",
    package_version: "1.5.0",
    package_name: "log4go",
    package_source_name: "github.com/example/log4go",
    package_manager: "go",
    package_ecosystem: "go",
    vuln_matching_ecosystem: "go",
  },
];
export const mockVulnIdsUnsolved = {
  vuln_ids: ["vuln-001", "vuln-002"],
};
export const mockVulnIdsSolved = {
  vuln_ids: ["vuln-003"],
};
export const mockTicketCountsUnsolved = {
  // vuln-001: immediate(2), out_of_cycle(1), scheduled(1), defer(1)
  // vuln-002: immediate(2), out_of_cycle(1), scheduled(1), defer(1)
  ssvc_priority_count: {
    immediate: 4,
    out_of_cycle: 2,
    scheduled: 2,
    defer: 2,
  },
};
export const mockTicketCountsSolved = {
  // vuln-003: immediate(2), out_of_cycle(1), scheduled(1), defer(1)
  ssvc_priority_count: {
    immediate: 2,
    out_of_cycle: 1,
    scheduled: 1,
    defer: 1,
  },
};
export const mockVulnDetails = {
  "vuln-001": {
    vuln_id: "vuln-001",
    title: "setuptools: Path Traversal Vulnerability",
    cve_id: "CVE-2023-12345",
    detail:
      "A path traversal vulnerability in setuptools allows an attacker to access arbitrary files on the filesystem by crafting a malicious package.",
    exploitation: "active",
    automatable: "yes",
    cvss_v3_score: 7.5,
    vulnerable_packages: [
      {
        ecosystem: "maven",
        affected_name: "log4j",
        affected_versions: ["1.2.0", "1.1.9"],
        fixed_versions: ["1.2.1"],
      },
    ],
    created_at: "2025-10-01T00:00:00Z",
    updated_at: "2025-10-21T00:00:00Z",
    created_by: "user-001",
  },
  "vuln-002": {
    vuln_id: "vuln-002",
    title: "pypa/setuptools: Remote code execution",
    cve_id: "CVE-2022-54321",
    detail:
      "A critical RCE vulnerability exists in the pypa/setuptools library, allowing unauthenticated attackers to execute arbitrary code.",
    exploitation: "active",
    automatable: "yes",
    cvss_v3_score: 9.8,
    vulnerable_packages: [
      {
        ecosystem: "maven",
        affected_name: "log4j",
        affected_versions: ["2.0.0", "1.9.9"],
        fixed_versions: ["2.1.0"],
      },
    ],
    created_at: "2025-09-15T00:00:00Z",
    updated_at: "2025-10-20T00:00:00Z",
    created_by: "user-002",
  },
  "vuln-003": {
    vuln_id: "vuln-003",
    title: "Log4j: Remote Code Execution (Log4Shell)",
    cve_id: "CVE-2021-44228",
    detail:
      "Apache Log4j2 <=2.14.1 JNDI features used in configuration, log messages, and parameters do not protect against attacker controlled LDAP and other JNDI related endpoints.",
    exploitation: "active",
    automatable: "yes",
    cvss_v3_score: 10.0,
    vulnerable_packages: [
      {
        ecosystem: "maven",
        affected_name: "log4j",
        affected_versions: ["2.14.1", "2.14.0"],
        fixed_versions: ["2.15.0", "2.16.0"],
      },
    ],
    created_at: "2025-08-01T00:00:00Z",
    updated_at: "2025-10-19T00:00:00Z",
    created_by: "user-003",
  },
};
export const mockVulnActions = {
  "vuln-001": [
    { action_type: "patch", recommended: true, action: "Apply patch provided by vendor." },
  ],
  "vuln-002": [],
  "vuln-003": [],
};
export const mockMembersList = [
  { user_id: "user-1", name: "Alice", email: "alice@example.com" },
  { user_id: "user-2", name: "Bob", email: "bob@example.com" },
  { user_id: "user-003", name: "Charlie", email: "charlie@example.com" },
];
export const mockUserMe = {
  user_id: "current-user-123",
  uid: "current-user",
  name: "Current User",
  email: "current.user@example.com",
  disabled: false,
  years: 5,
  pteam_roles: [],
};
// --- Tickets Data (vuln-001) ---
export const mockTicketsVuln001 = [
  {
    ticket_id: "ticket-100",
    vuln_id: "vuln-001",
    dependency_id: "dep-1",
    service_id: serviceId,
    pteam_id: pteamId,
    ssvc_deployer_priority: "immediate",
    ticket_safety_impact: "catastrophic",
    ticket_safety_impact_change_reason: "Critical vulnerability in dep-1",
    ticket_status: {
      status_id: "status-100",
      ticket_handling_status: "alerted",
      user_id: "user-001",
      created_at: "2025-11-25T16:51:50.032Z",
      updated_at: "2025-11-25T16:51:50.032Z",
      assignees: [],
      note: "Initial alert - 未着手",
      scheduled_at: null,
      action_logs: [],
      current_safety_impact: "catastrophic",
    },
  },
  {
    ticket_id: "ticket-101",
    vuln_id: "vuln-001",
    dependency_id: "dep-2",
    service_id: serviceId,
    pteam_id: pteamId,
    ssvc_deployer_priority: "out_of_cycle",
    ticket_safety_impact: "major",
    ticket_safety_impact_change_reason: "Under investigation",
    ticket_status: {
      status_id: "status-101",
      ticket_handling_status: "acknowledged",
      user_id: "user-002",
      created_at: "2025-11-26T08:00:00.032Z",
      updated_at: "2025-11-26T09:00:00.032Z",
      assignees: ["user-003"],
      note: "Acknowledged - 対応中",
      scheduled_at: null,
      action_logs: [],
      current_safety_impact: "major",
    },
  },
  {
    ticket_id: "ticket-102",
    vuln_id: "vuln-001",
    dependency_id: "dep-3",
    service_id: serviceId,
    pteam_id: pteamId,
    ssvc_deployer_priority: "scheduled",
    ticket_safety_impact: "minor",
    ticket_safety_impact_change_reason: "Low priority issue",
    ticket_status: {
      status_id: "status-102",
      ticket_handling_status: "scheduled",
      user_id: "user-001",
      created_at: "2025-11-27T10:00:00.032Z",
      updated_at: "2025-11-27T10:00:00.032Z",
      assignees: [],
      note: "Scheduled for next sprint",
      scheduled_at: "2025-12-01T00:00:00.032Z",
      action_logs: [],
      current_safety_impact: "minor",
    },
  },
  {
    ticket_id: "ticket-103",
    vuln_id: "vuln-001",
    dependency_id: "dep-4",
    service_id: serviceId,
    pteam_id: pteamId,
    ssvc_deployer_priority: "defer",
    ticket_safety_impact: "negligible",
    ticket_safety_impact_change_reason: "Minimal impact",
    ticket_status: {
      status_id: "status-103",
      ticket_handling_status: "completed",
      user_id: "user-003",
      created_at: "2025-11-20T08:00:00.032Z",
      updated_at: "2025-11-24T08:00:00.032Z",
      assignees: [],
      note: "Completed - resolved",
      scheduled_at: null,
      action_logs: [],
      current_safety_impact: "negligible",
    },
  },
  {
    ticket_id: "ticket-104",
    vuln_id: "vuln-001",
    dependency_id: "dep-5",
    service_id: serviceId,
    pteam_id: pteamId,
    ssvc_deployer_priority: "immediate",
    ticket_safety_impact: null,
    ticket_safety_impact_change_reason: null,
    ticket_status: {
      status_id: "status-104",
      ticket_handling_status: "alerted",
      user_id: "user-001",
      created_at: "2025-11-28T10:00:00.032Z",
      updated_at: "2025-11-28T10:00:00.032Z",
      assignees: [],
      note: "Using default safety impact",
      scheduled_at: null,
      action_logs: [],
      current_safety_impact: null,
    },
  },
];
// --- Tickets Data (vuln-002) ---
export const mockTicketsVuln002 = [
  {
    ticket_id: "ticket-200",
    vuln_id: "vuln-002",
    dependency_id: "dep-1",
    service_id: serviceId,
    pteam_id: pteamId,
    ssvc_deployer_priority: "immediate",
    ticket_safety_impact: "catastrophic",
    ticket_safety_impact_change_reason: "Critical vulnerability in dep-1",
    ticket_status: {
      status_id: "status-200",
      ticket_handling_status: "alerted",
      user_id: "user-001",
      created_at: "2025-11-25T16:51:50.032Z",
      updated_at: "2025-11-25T16:51:50.032Z",
      assignees: [],
      note: "Initial alert",
      scheduled_at: null,
      action_logs: [],
      current_safety_impact: "catastrophic",
    },
  },
  {
    ticket_id: "ticket-201",
    vuln_id: "vuln-002",
    dependency_id: "dep-2",
    service_id: serviceId,
    pteam_id: pteamId,
    ssvc_deployer_priority: "out_of_cycle",
    ticket_safety_impact: "major",
    ticket_safety_impact_change_reason: "Under investigation",
    ticket_status: {
      status_id: "status-201",
      ticket_handling_status: "acknowledged",
      user_id: "user-002",
      created_at: "2025-11-26T08:00:00.032Z",
      updated_at: "2025-11-26T09:00:00.032Z",
      assignees: ["user-003"],
      note: "Acknowledged",
      scheduled_at: null,
      action_logs: [],
      current_safety_impact: "major",
    },
  },
  {
    ticket_id: "ticket-202",
    vuln_id: "vuln-002",
    dependency_id: "dep-3",
    service_id: serviceId,
    pteam_id: pteamId,
    ssvc_deployer_priority: "scheduled",
    ticket_safety_impact: "minor",
    ticket_safety_impact_change_reason: "Low priority",
    ticket_status: {
      status_id: "status-202",
      ticket_handling_status: "scheduled",
      user_id: "user-001",
      created_at: "2025-11-27T10:00:00.032Z",
      updated_at: "2025-11-27T10:00:00.032Z",
      assignees: [],
      note: "Scheduled",
      scheduled_at: "2025-12-01T00:00:00.032Z",
      action_logs: [],
      current_safety_impact: "minor",
    },
  },
  {
    ticket_id: "ticket-203",
    vuln_id: "vuln-002",
    dependency_id: "dep-4",
    service_id: serviceId,
    pteam_id: pteamId,
    ssvc_deployer_priority: "defer",
    ticket_safety_impact: "negligible",
    ticket_safety_impact_change_reason: "Minimal impact",
    ticket_status: {
      status_id: "status-203",
      ticket_handling_status: "completed",
      user_id: "user-003",
      created_at: "2025-11-20T08:00:00.032Z",
      updated_at: "2025-11-24T08:00:00.032Z",
      assignees: [],
      note: "Completed",
      scheduled_at: null,
      action_logs: [],
      current_safety_impact: "negligible",
    },
  },
  {
    ticket_id: "ticket-204",
    vuln_id: "vuln-002",
    dependency_id: "dep-5",
    service_id: serviceId,
    pteam_id: pteamId,
    ssvc_deployer_priority: "immediate",
    ticket_safety_impact: null,
    ticket_safety_impact_change_reason: null,
    ticket_status: {
      status_id: "status-204",
      ticket_handling_status: "alerted",
      user_id: "user-001",
      created_at: "2025-11-28T10:00:00.032Z",
      updated_at: "2025-11-28T10:00:00.032Z",
      assignees: [],
      note: "Using default safety impact",
      scheduled_at: null,
      action_logs: [],
      current_safety_impact: null,
    },
  },
];
// --- Tickets Data (vuln-003) ---
export const mockTicketsVuln003 = [
  {
    ticket_id: "ticket-300",
    vuln_id: "vuln-003",
    dependency_id: "dep-1",
    service_id: serviceId,
    pteam_id: pteamId,
    ssvc_deployer_priority: "immediate",
    ticket_safety_impact: "catastrophic",
    ticket_safety_impact_change_reason: "Critical vulnerability",
    ticket_status: {
      status_id: "status-300",
      ticket_handling_status: "alerted",
      user_id: "user-001",
      created_at: "2025-11-25T16:51:50.032Z",
      updated_at: "2025-11-25T16:51:50.032Z",
      assignees: [],
      note: "Initial alert",
      scheduled_at: null,
      action_logs: [],
      current_safety_impact: "catastrophic",
    },
  },
  {
    ticket_id: "ticket-301",
    vuln_id: "vuln-003",
    dependency_id: "dep-2",
    service_id: serviceId,
    pteam_id: pteamId,
    ssvc_deployer_priority: "out_of_cycle",
    ticket_safety_impact: "major",
    ticket_safety_impact_change_reason: "Under investigation",
    ticket_status: {
      status_id: "status-301",
      ticket_handling_status: "acknowledged",
      user_id: "user-002",
      created_at: "2025-11-26T08:00:00.032Z",
      updated_at: "2025-11-26T09:00:00.032Z",
      assignees: ["user-003"],
      note: "Acknowledged",
      scheduled_at: null,
      action_logs: [],
      current_safety_impact: "major",
    },
  },
  {
    ticket_id: "ticket-302",
    vuln_id: "vuln-003",
    dependency_id: "dep-3",
    service_id: serviceId,
    pteam_id: pteamId,
    ssvc_deployer_priority: "scheduled",
    ticket_safety_impact: "minor",
    ticket_safety_impact_change_reason: "Low priority",
    ticket_status: {
      status_id: "status-302",
      ticket_handling_status: "scheduled",
      user_id: "user-001",
      created_at: "2025-11-27T10:00:00.032Z",
      updated_at: "2025-11-27T10:00:00.032Z",
      assignees: [],
      note: "Scheduled",
      scheduled_at: "2025-12-01T00:00:00.032Z",
      action_logs: [],
      current_safety_impact: "minor",
    },
  },
  {
    ticket_id: "ticket-303",
    vuln_id: "vuln-003",
    dependency_id: "dep-4",
    service_id: serviceId,
    pteam_id: pteamId,
    ssvc_deployer_priority: "defer",
    ticket_safety_impact: "negligible",
    ticket_safety_impact_change_reason: "Minimal impact",
    ticket_status: {
      status_id: "status-303",
      ticket_handling_status: "completed",
      user_id: "user-003",
      created_at: "2025-11-20T08:00:00.032Z",
      updated_at: "2025-11-24T08:00:00.032Z",
      assignees: [],
      note: "Completed",
      scheduled_at: null,
      action_logs: [],
      current_safety_impact: "negligible",
    },
  },
  {
    ticket_id: "ticket-304",
    vuln_id: "vuln-003",
    dependency_id: "dep-5",
    service_id: serviceId,
    pteam_id: pteamId,
    ssvc_deployer_priority: "immediate",
    ticket_safety_impact: null,
    ticket_safety_impact_change_reason: null,
    ticket_status: {
      status_id: "status-304",
      ticket_handling_status: "alerted",
      user_id: "user-001",
      created_at: "2025-11-28T10:00:00.032Z",
      updated_at: "2025-11-28T10:00:00.032Z",
      assignees: [],
      note: "Using default safety impact",
      scheduled_at: null,
      action_logs: [],
      current_safety_impact: null,
    },
  },
];
// ハンドラーはhandlers.jsから再export
export { createDefaultHandlers } from "./handlers";
