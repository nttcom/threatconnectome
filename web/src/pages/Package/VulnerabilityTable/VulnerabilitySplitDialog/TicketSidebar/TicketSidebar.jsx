import { Info, KeyboardArrowRight } from "@mui/icons-material";
import { Box, Button } from "@mui/material";
import { amber, orange } from "@mui/material/colors";
import PropTypes from "prop-types";

import { TicketListSection } from "./TicketListSection";

export function TicketSidebar({
  selectedTicketId,
  onSelect,
  onShowInfo,
  mobileView,
  isMobile,
  cveId,
}) {
  const activeSelectedId = isMobile && mobileView === "list" ? null : selectedTicketId;

  const statuses = ["alerted", "in-progress", "completed"];

  return (
    <>
      {isMobile && (
        <Box sx={{ p: 2, bgcolor: orange[50], borderBottom: 1, borderColor: orange[200] }}>
          <Button
            fullWidth
            variant="outlined"
            color="warning"
            startIcon={<Info />}
            endIcon={<KeyboardArrowRight />}
            onClick={onShowInfo}
            sx={{
              justifyContent: "space-between",
              fontWeight: "bold",
              borderColor: orange[200],
              "&:hover": {
                bgcolor: amber[50],
                borderColor: orange[300],
              },
            }}
          >
            {cveId ? `${cveId} - Check Details` : "Check Vulnerability Details"}
          </Button>
        </Box>
      )}

      {statuses.map((status) => (
        <TicketListSection
          key={status}
          statusFilter={status}
          selectedId={activeSelectedId}
          onSelect={onSelect}
        />
      ))}
    </>
  );
}

TicketSidebar.propTypes = {
  selectedTicketId: PropTypes.string,
  onSelect: PropTypes.func.isRequired,
  onShowInfo: PropTypes.func.isRequired,
  mobileView: PropTypes.string,
  isMobile: PropTypes.bool.isRequired,
  cveId: PropTypes.string,
};
