import { Info, KeyboardArrowRight } from "@mui/icons-material";
import { alpha, Box, Button } from "@mui/material";
import { amber, orange } from "@mui/material/colors";
import PropTypes from "prop-types";
import { useTranslation } from "react-i18next";

import { TicketListSection } from "./TicketListSection";

export function TicketSidebar({
  selectedTicketId,
  onSelect,
  onShowVulnInfo,
  mobileView,
  isMobile,
  cveId,
  severityColor,
}) {
  const { t } = useTranslation("package", {
    keyPrefix: "VulnerabilityTable.VulnerabilitySplitDialog.TicketSidebar.TicketSidebar",
  });
  const activeSelectedId = isMobile && mobileView === "list" ? null : selectedTicketId;

  const statuses = ["alerted", "in-progress", "completed"];

  return (
    <>
      {isMobile && (
        <Box
          sx={{
            p: 2,
            bgcolor: alpha(severityColor, 0.08),
            borderBottom: 1,
            borderColor: "divider",
          }}
        >
          <Button
            fullWidth
            variant="outlined"
            color="warning"
            startIcon={<Info />}
            endIcon={<KeyboardArrowRight />}
            onClick={onShowVulnInfo}
            sx={{
              justifyContent: "space-between",
              fontWeight: "bold",
              borderColor: orange[200],
              "&:hover": {
                bgcolor: amber[50],
                borderColor: orange[300],
              },
            }}
          >
            {cveId ? `${cveId} - ${t("checkDetails")}` : t("checkVulnerabilityDetails")}
          </Button>
        </Box>
      )}

      {statuses.map((status) => (
        <TicketListSection
          key={status}
          statusFilter={status}
          selectedId={activeSelectedId}
          onSelect={onSelect}
        />
      ))}
    </>
  );
}

TicketSidebar.propTypes = {
  selectedTicketId: PropTypes.string,
  onSelect: PropTypes.func.isRequired,
  onShowVulnInfo: PropTypes.func.isRequired,
  mobileView: PropTypes.string,
  isMobile: PropTypes.bool.isRequired,
  cveId: PropTypes.string,
  severityColor: PropTypes.string.isRequired,
};
