// PaginationControls.jsx

import MoreVertIcon from "@mui/icons-material/MoreVert";
import {
  Box,
  Dialog,
  DialogContent,
  DialogTitle,
  FormControl, // ▼ 追加
  FormControlLabel, // ▼ 追加
  IconButton,
  Pagination,
  Radio, // ▼ 追加
  RadioGroup, // ▼ 追加
  Typography,
} from "@mui/material";
import PropTypes from "prop-types";
import { useState } from "react";

export function PaginationControls({
  pageCount,
  page,
  onPageChange,
  itemsPerPage,
  onItemsPerPageChange,
}) {
  const [isDialogOpen, setIsDialogOpen] = useState(false);

  const handleOpenDialog = () => {
    setIsDialogOpen(true);
  };

  const handleCloseDialog = () => {
    setIsDialogOpen(false);
  };

  // ▼ RadioGroupの変更を処理するハンドラ
  const handleRadioChange = (event) => {
    onItemsPerPageChange(event); // 親のハンドラを呼び出す
    handleCloseDialog(); // ダイアログを閉じる
  };

  return (
    <Box
      sx={{
        display: "flex",
        justifyContent: "center",
        alignItems: "center",
        gap: { xs: 1, sm: 2 },
        flexWrap: "wrap",
      }}
    >
      <Pagination
        count={pageCount}
        page={page}
        onChange={onPageChange}
        color="primary"
        siblingCount={0}
      />

      <Box sx={{ display: "flex", alignItems: "center" }}>
        <Typography variant="body2" color="text.secondary" sx={{ mr: 1 }}>
          {`${itemsPerPage} rows`}
        </Typography>
        <IconButton onClick={handleOpenDialog}>
          <MoreVertIcon />
        </IconButton>

        <Dialog onClose={handleCloseDialog} open={isDialogOpen}>
          <DialogTitle>Rows per page</DialogTitle>
          <DialogContent>
            {/* ▼ 変更: Listの代わりにFormControlとRadioGroupを使用 */}
            <FormControl>
              <RadioGroup
                aria-labelledby="items-per-page-radio-group"
                name="items-per-page"
                value={itemsPerPage}
                onChange={handleRadioChange}
              >
                {[10, 25, 50].map((option) => (
                  <FormControlLabel
                    key={option}
                    value={option}
                    control={<Radio />}
                    label={`Show ${option}`}
                  />
                ))}
              </RadioGroup>
            </FormControl>
          </DialogContent>
        </Dialog>
      </Box>
    </Box>
  );
}

PaginationControls.propTypes = {
  pageCount: PropTypes.number.isRequired,
  page: PropTypes.number.isRequired,
  onPageChange: PropTypes.func.isRequired,
  itemsPerPage: PropTypes.number.isRequired,
  onItemsPerPageChange: PropTypes.func.isRequired,
};
